# RecommendationSystem
记录推荐系统中的一些值得注意的工作和技巧
# 特征部分 
1.特征获取，有下发事件和上报事件两种，都是从后台日志Log中解析获得数据；
2.数据需要根据不同的特征采用不同的处理流程，实时性高的特征需要用流式数据的处理方式，实时性较弱的特征可以离线周期性统计，还有更新非常慢的静态特征
3.label的数据是从日志中获取的，不同的事件以及事件发生的时间点
4.特征获取好了之后，一般写入某个缓存中，供线上服务调用
5.离线训练的数据可以与线上调用共用同一套，这样就避免了线上线下特征不一致的问题
6.特征的调用最好约定一个强约束的格式，可以避免环境和类型以及默认值导致的不一致，目前是采用proto的格式
# 流程部分
1.召回，比较重要，决定了排序的基础。规则外加模型，模型用来体现兴趣，规则用来控制流量。目前采用双塔模型，召回的最大的问题在于样本稀少的主播（item）不能得到较好的训练，相当于是item侧的冷启动问题，负采样可能是一个解决办法
2.排序，排序模型的建模目标很重要，带约束的多目标模型是目前使用的比较好的模型。排序的性能能从离线auc上得到体现，但是并不能完全区分线上的效果，差别在于推荐系统是列表展示的，展示的上下文天然会影响点击率等指标。
3.目前流程是，数据生成tfrecord,特征采用特征列的形式，核心功能用estimator,checkpoint做到增量更新，tserving用于提供模型服务
4.rerank是比较贴近业务的一个流程，主要用来控制显示界面的多样性，业务侧的流量分配需求和加入一些运营的规则需求
5.刷新机制，下发过滤和过滤过期是非常重要的，不能一直出现重复的内容，用户的点击和刷新行为应该能够改变后续的列表
# 实验部分
1.离线测试很重要，需要有比较好的实验记录习惯和工具
2.上线前的ab测试必不可少，从流量分配的角度，不同的流程层甚至不同的实验，应该划分为正交的不同的实验层，这样才能避免实验流量不够用的问题
# 难点部分
1.新用户的推荐策略是比较难做的，但是同时也是收获最大的
2.排序模型的最终归宿还是在强化学习上，机器学习具有技术难度低，上线快，业务成熟的有点，但这些都会被越来越广泛的应用强化学习打败。
